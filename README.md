# glob-library-go

Glob style pattern matcher for strings in Go.

## Why

Port of the https://github.com/hrakaroo/glob-library-java library
to Go.  All code (including tests) have been pulled over and converted. 
Everything compiles and all tests pass. Main benchmark for GlobEngine is is done.
Still have a couple of additional benchmarks to run before calling it officially 
done, but it's pretty close.

### Related work

There are already several glob implementations (https://go.dev/src/path/filepath/match.go 
and https://pkg.go.dev/v.io/v23/glob among others), but most seem to be focused
on file paths and treat slash as a hard separator.

## Code Coverage

The [code coverage report](https://htmlpreview.github.io/?https://github.com/hrakaroo/glob-library-go/blob/master/coverage.html) was generated by running:

```
go test -coverprofile coverage.out
go tool cover -html=coverage.out -o coverage.html
```

Files
```
100.0% for engine.go
100.0% for compiler.go
```

Overall
```
100.0% of statements
```

Added some compile option tests and the library is now at 100% code test coverage.

## Releases

To use it add

`require github.com/hrakaroo/glob-library-go v0.2.1-beta`

in your `go.mod` file and then import the library in your code.  
For my simple test this worked pretty well:

```
import glob "github.com/hrakaroo/glob-library-go"

func main() {
	fmt.Println("hello")
	m, err := glob.Compile("*foo*")
	if err != nil {
		panic(err)
	}

	fmt.Println(m.Matches("bogfoo"))
}
```

### v0.1.0-alpha

First tagged version of this library.

### v0.2.1-beta

Fixed the alloc issue with this version.  I may want to add a couple more 
benchmark test, but this is pretty close to being ready for production.

## Performance

For both the globWords and globLogLines benchmarks the glob pattern has been written 
specifically to prevent the Glob library from using an optimization.

```
> go test -bench . -benchmem
goos: darwin
goarch: amd64
pkg: github.com/hrakaroo/glob-library-go
cpu: Intel(R) Core(TM) i7-7660U CPU @ 2.50GHz
BenchmarkGlobWords-4                	      43	  28000556 ns/op	     528 B/op	      26 allocs/op
BenchmarkGreedyRegexWords-4         	       7	 168131805 ns/op	   14853 B/op	      92 allocs/op
BenchmarkNonGreedyRegexWords-4      	       6	 176012549 ns/op	    9574 B/op	      92 allocs/op
BenchmarkGlobLogLines-4             	      21	  54344059 ns/op	     528 B/op	      26 allocs/op
BenchmarkGreedyRegexLogLines-4      	       4	 297334020 ns/op	  108286 B/op	      95 allocs/op
BenchmarkNonGreedyRegexLogLines-4   	       4	 304755895 ns/op	    9618 B/op	      92 allocs/op
PASS
ok  	github.com/hrakaroo/glob-library-go	9.912s
```

I have not spent a huge amount of time on this so I may not be running the benchmark entirely correct.
That said, for both `words` and `logLines` the glob library is considerably faster than both the greedy 
and non greedy regex runs and have the fewest number of allocations.
