# glob-library-go

Glob style pattern matcher for strings in Go.

## Why

This is a port of my https://github.com/hrakaroo/glob-library-java library
to Go.  All of the code (including tests) have been pulled over and converted. 
Everything compiles and all tests pass. I still want to run some benchmarks 
before calling it "done".

I also acknowledge that this library isn't as _needed_ for Go since Go ships
with it's own https://go.dev/src/path/filepath/match.go and https://pkg.go.dev/v.io/v23/glob 
which looks to operate pretty similar.

## Code Coverage

The [code coverage report](https://htmlpreview.github.io/?https://github.com/hrakaroo/glob-library-go/blob/master/coverage.html) was generated by running:

```
go test -coverprofile coverage.out
go tool cover -html=coverage.out -o coverage.html
```

Files
```
100.0% for engine.go
100.0% for compiler.go
```

Overall
```
100.0% of statements
```

Added some compile option tests and the library is now at 100% code test coverage.

## Releases

### v0.1.0-alpha

First tagged version of this library. To use it add

`require github.com/hrakaroo/glob-library-go v0.1.0-alpha`

in your `go.mod` file and then import the library with

`import glob "github.com/hrakaroo/glob-library-go"`

in your code.  For my simple test this worked pretty well:

```
func main() {
	fmt.Println("hello")
	m, err := glob.Compile("*foo*")
	if err != nil {
		panic(err)
	}

	fmt.Println(m.Matches("bogfoo"))
}
```

## Performance

For both the globWords and globLogLines benchmarks the glob pattern has been written 
specifically to prevent the Glob library from using an optimization.

```
> go test -bench . -benchmem
goos: darwin
goarch: amd64
pkg: github.com/hrakaroo/glob-library-go
cpu: Intel(R) Core(TM) i7-7660U CPU @ 2.50GHz
BenchmarkGlobWords-4                	      32	  47255998 ns/op	     480 B/op	      20 allocs/op
BenchmarkGreedyRegexWords-4         	       6	 171364844 ns/op	    9574 B/op	      92 allocs/op
BenchmarkNonGreedyRegexWords-4      	       6	 168362782 ns/op	    9574 B/op	      92 allocs/op
BenchmarkGlobLogLines-4             	      15	  73967985 ns/op	58958800 B/op	   59546 allocs/op
BenchmarkGreedyRegexLogLines-4      	       4	 299777088 ns/op	  108288 B/op	      95 allocs/op
BenchmarkNonGreedyRegexLogLines-4   	       3	 392486405 ns/op	  141218 B/op	      96 allocs/op
PASS
ok  	github.com/hrakaroo/glob-library-go	10.270s
```

I have not spent a huge amount of time on this so I may not be running the benchmark entirely correctly.
That said, for both words and log lines the glob library is considerably faster than both the greedy 
and non greedy regex runs.  That said, for the log lines run the the glob library has a significantly
larger number of bytes and allocations ... which I find bothersome.

I'm going to poke around a bit and see if I can figure out what is causing this.